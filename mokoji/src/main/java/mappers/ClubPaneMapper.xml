<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ClubPaneDAO">

	<insert id="insertClubPane" parameterType="hashmap">
		INSERT INTO CLUBPANE (cp_code, cp_name, cp_content, cp_date, cp_pic, cp_rpic, cp_cnt, cp_likes, mc_code) 
		VALUES(seq_clubpane.nextval, #{clubpane.cp_name}, #{clubpane.cp_content}, sysdate, #{clubpane.cp_pic}, #{clubpane.cp_rpic},0, 0, #{ memclub.mc_code })
	</insert>

	<select id="selectClubPaneList" parameterType="club" resultType="hashmap">
	SELECT p.CP_CODE, p.CP_NAME, p.CP_CONTENT, p.CP_DATE, p.CP_PIC, p.CP_CNT, p.CP_LIKES, p.MC_CODE, m.MEM_NAME, p.CP_RPIC FROM CLUBPANE p, MEMCLUB c, MEMBER m 
	WHERE CLUB_CODE = ${club_code} AND p.MC_CODE = c.MC_CODE AND c.MEM_CODE = m.MEM_CODE
	</select>
	
	<update id="updateHeart">
	UPDATE CLUBPANE SET CP_LIKES = CP_LIKES + 1 WHERE CP_CODE = #{cp_code}
	</update>

	<select id="getOneClubPane" resultType="clubpane" parameterType="integer">
	SELECT CP_CODE, CP_NAME, CP_CONTENT, CP_DATE, CP_PIC, CP_CNT, CP_LIKES, MC_CODE FROM CLUBPANE WHERE CP_CODE = #{cp_code}
	</select>
	
	<update id="downHeart">
	UPDATE CLUBPANE SET CP_LIKES = CP_LIKES - 1 WHERE CP_CODE = #{cp_code}
	</update>
	
</mapper>

